# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏: U-Net vs SegFormer


## üìå –í–≤–µ–¥–µ–Ω–∏–µ
–ü—Ä–æ–µ–∫—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –¥–≤–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏:
1. **U-Net** ([Ronneberger et al., 2015](#1)) ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –Ω–∞ —Å–≤—ë—Ä—Ç–æ—á–Ω—ã—Ö —Å–µ—Ç—è—Ö —Å skip-connections.
2. **SegFormer** ([Xie et al., 2021](#2)) ‚Äî —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å —Å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–º —ç–Ω–∫–æ–¥–µ—Ä–æ–º.

**–¶–µ–ª—å**: –û—Ü–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ CamVid –ø–æ:
- –ö–∞—á–µ—Å—Ç–≤—É (mIoU)
- –°–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è
- –ö–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## üõ† –ú–µ—Ç–æ–¥—ã
### 1. U-Net
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
    - –≠–Ω–∫–æ–¥–µ—Ä: ResNet34 (–ø—Ä–µ–¥–æ–±—É—á–µ–Ω –Ω–∞ ImageNet)
    - –î–µ–∫–æ–¥–µ—Ä: –ë–ª–æ–∫–∏ –∞–ø—Å–µ–º–ø–ª–∏–Ω–≥–∞ —Å skip-connections
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
    - –í—ã—Å–æ–∫–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
    - –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 2. SegFormer
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
    - –≠–Ω–∫–æ–¥–µ—Ä: –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä (MIT-B0)
    - –î–µ–∫–æ–¥–µ—Ä: –õ—ë–≥–∫–∏–π MLP-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
    - –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ self-attention
    - –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏

## üß™ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
### –î–∞—Ç–∞—Å–µ—Ç
- **CamVid** (367 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö / 101 –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: 256√ó256 –ø–∏–∫—Å–µ–ª–µ–π
- 32 –∫–ª–∞—Å—Å–∞ (–¥–æ—Ä–æ–≥–∞, –∑–¥–∞–Ω–∏—è, –ø–µ—à–µ—Ö–æ–¥—ã –∏ –¥—Ä.)

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
| –ü–∞—Ä–∞–º–µ—Ç—Ä       | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------------|----------|
| Batch size     | 4        |
| Learning rate  | 1e-4     |
| Epochs         | 15       |
| –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä    | Adam     |

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
| –ú–µ—Ç—Ä–∏–∫–∞          | U-Net    | SegFormer | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------------------|----------|-----------|--------|
| –ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–º–ª–Ω)  | 24.4     | **3.7**   | -84.8% |
| –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è   | 171.4s   | **144.7s**| -15.6% |
| –õ—É—á—à–∏–π mIoU      | 0.4814   | **0.5682**| +18.0% |

### –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è
(–í —Ñ–∞–π–ª–µ .ipynb)

**–ö–ª—é—á–µ–≤—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è**:
1. **SegFormer**:
    - –ù–∞ 18% –≤—ã—à–µ –∏—Ç–æ–≥–æ–≤—ã–π mIoU.
    - –ü–ª–∞–≤–Ω—ã–π —Ä–æ—Å—Ç –∫–∞—á–µ—Å—Ç–≤–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.
    - –ë—ã—Å—Ç—Ä–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å (Loss –ø–∞–¥–∞–µ—Ç —Å 1.70 –¥–æ 0.24).

2. **U-Net**:
    - –†–∞–Ω–Ω–µ–µ –ø–ª–∞—Ç–æ –ø–æ—Å–ª–µ 10-–π —ç–ø–æ—Ö–∏.
    - –í—ã—Å–æ–∫–∞—è –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å mIoU –∏–∑-–∑–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

## üéØ –í—ã–≤–æ–¥—ã
1. **–ü–æ—á–µ–º—É SegFormer –ª—É—á—à–µ?**
    - **–ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç**: Self-attention –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É —É–¥–∞–ª—ë–Ω–Ω—ã–º–∏ —Ä–µ–≥–∏–æ–Ω–∞–º–∏.
    - **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ù–∞ 85% –º–µ–Ω—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–ª–∞–≥–æ–¥–∞—Ä—è lightweight-–¥–µ–∫–æ–¥–µ—Ä—É.
    - **–ü—Ä–µ–¥–æ–±—É—á–µ–Ω–∏–µ**: –≠–Ω–∫–æ–¥–µ—Ä MIT-B0 –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –≤–µ—Å–∞–º–∏ ImageNet.

2. **–ö–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—Ç—å U-Net?**
    - –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∑–∞–¥–∞—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π).
    - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (CPU-–∏–Ω—Ñ–µ—Ä–µ–Ω—Å).

3. **–ü–∞—Ä–∞–¥–æ–∫—Å SegFormer**:
    - –ú–µ–Ω—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚Üí –ª—É—á—à–µ –æ–±–æ–±—â–µ–Ω–∏–µ.
    - –û–±—ä—è—Å–Ω–µ–Ω–∏–µ: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∑–∞ —Å—á—ë—Ç –≤–Ω–∏–º–∞–Ω–∏—è –∫–æ –≤—Å–µ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é.

## üí° –ì–∏–ø–æ—Ç–µ–∑–∞ —É–ª—É—á—à–µ–Ω–∏—è SegFormer
**–ò–¥–µ—è**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ **–ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏** —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ 4 —É—Ä–æ–≤–Ω–µ–π —ç–Ω–∫–æ–¥–µ—Ä–∞.

**–û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è**:
- +2-3% mIoU –∑–∞ —Å—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π.
- -20% —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (–∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é).

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**:
1. –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Å–ª–æ–∏ —ç–Ω–∫–æ–¥–µ—Ä–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
2. –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ä–∞–∑–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞ —É–ª—É—á—à–∞–µ—Ç –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—é.
3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ skip-connections –º–µ–∂–¥—É —ç–Ω–∫–æ–¥–µ—Ä–æ–º –∏ –¥–µ–∫–æ–¥–µ—Ä–æ–º.

## üìö –°—Å—ã–ª–∫–∏
<a id="1">[1]</a> Ronneberger, O., Fischer, P., & Brox, T. (2015). [U-Net: Convolutional Networks for Biomedical Image Segmentation](https://arxiv.org/abs/1505.04597). MICCAI.

<a id="2">[2]</a> Xie, E., et al. (2021). [SegFormer: Simple and Efficient Design for Semantic Segmentation with Transformers](https://arxiv.org/abs/2105.15203). NeurIPS.
